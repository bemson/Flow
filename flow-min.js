/*
 * Flow v0.2.0
 * http://github.com/bemson/Flow/
 *
 * GSet v1.0.0
 * http://github.com/bemson/GSet/
 *
 * Copyright 2011, Bemi Faison
 * Both released under the MIT License
 */
(function(){var a={gvsCall:function(g,f,d,c,b){return(function e(){return g.apply(f,d)}).apply(c,b)},gsetCall:function(b,c){return function(){return b._gset.apply(b,[c].concat(arguments.length?[].slice.call(arguments):[]))}},customCall:function(e,c,d,b,g){var f=[b,d,"custom"];return function(){var h=arguments;if(!g(h,f)){return !1}return a.gvsCall(c[d],e,h,b,f)}},typeMap:{string:"s","[object Array]":"a","function":"f","[object Function]":"f"},rxp:{rtnFnc:/\breturn\b/,fsType:/[fs]/,afsType:/[afs]/},getType:function(c){var b=a.typeMap[typeof c]||a.typeMap[Object.prototype.toString.call(c)];return b&&(b!=="s"||b.length)?b:0},testValueTypes:function(f,b){var e=0,c=b.length,h,k=f.length,d,g=1;for(;e<c;e++){d=typeof b[e];g=0;for(h=0;h<k;h++){if(f[h]===d){g=1;break}}if(!g){break}}return g}};GSet=function(b,c){var f=this,k=arguments,i,g,o=a.rxp.rtnFnc,h=a.getType,m={},n=function(q,s){var r=s[1],p=!m[r];if(p&&h){m[r]=1;if(a.gvsCall(h,b,q,f,s)===!1){p=0}m[r]=0}return p},e,d,l,j;if(!(f.hasOwnProperty&&f instanceof GSet)){throw new Error("GSet: missing new operator")}if(b==null){throw new Error("GSet: invalid source")}if(k.length>2){if(k.length>3){h=[typeof k[2],typeof k[3],"function"];if((h[0]===h[2])===(h[1]===h[2])){throw new Error("GSet: too many or too few gate functions")}o=k[h[0]===h[2]?3:2];h=k[h[0]===h[2]?2:3]}else{if(typeof k[2]==="function"){h=k[2]}else{o=k[2]}}}if(c instanceof GSet){c=c._gset(a);i=c[0];g=c[1];if(o===a.rxp.rtnFnc){o=c[2]}if(h===a.getType){h=c[3]}c=c[4];for(l in g){if(g.hasOwnProperty(l)){m[l]=0;if(g[l]===2){f[l]=a.customCall(b,c,l,f,n)}else{f[l]=a.gsetCall(f,l)}}}}else{i={};g={};for(l in c){if(!c.hasOwnProperty(l)){continue}m[l]=0;e=c[l];d=a.getType(e);if(d==="f"){f[l]=a.customCall(b,c,l,f,n);g[l]=2}else{j={get:0,set:0};if(d!=="a"||(e.length===1&&(d=a.getType(e[0]))==="a")){if(d==="a"){c[l]=e[0];j.isAry=1}j.get=1;j.fixed=1;j.fixedValue=c[l]}else{if(!e.length){e=c[l]=[l,1]}d=[a.getType(e[0]),a.getType(e[1]),a.getType(e[2])];if((d[0]==="f"&&!a.rxp.rtnFnc.test(e[0]+""))||(d[1]==="f"&&!a.rxp.rtnFnc.test(e[1]+""))){continue}if(e[0]){j.get=1;j[d[0]==="f"?"getter":"getProperty"]=a.rxp.fsType.test(d[0])?e[0]:l}if(e[2]){j.set=1;j.validAny=1;if(a.rxp.fsType.test(d[2])){j[d[2]==="f"?"setter":"setProperty"]=e[2]}else{if(j.get){j[j.getter?"setter":"setProperty"]=j.getter||j.getProperty}}}else{if(e.length>2){j.set=0}}if(e[1]&&(e.length<3||j.set)){j.set=1;j.validAny=!a.rxp.afsType.test(d[1]);if(!j.validAny){j[d[1]==="f"?"validator":"types"]=d[1]==="s"?[e[1]]:e[1]}}}if(j.get||j.set){g[l]=j.get-j.set;i[l]=j;f[l]=a.gsetCall(f,l)}}}}if(h===a.getType){h=0}f._gset=function(t){var s=arguments,q=[].slice.call(arguments,1),u=q.length,v=u?"set":"get",w=[f,t,u?"vet":v],p=i.hasOwnProperty(t)&&i[t],r;if(!s.length){r=function(){};r.prototype=g;return new r()}if(t===o){return b}if(t===a){return[i,g,o,h,c]}if(p){if(p[v]){if(!n(q,w)){return !1}if(p.fixed){return p.isAry?p.fixedValue.concat():p.fixedValue}if(u){if(p.validAny||(p.validator&&a.gvsCall(p.validator,b,q,f,w))||(p.types&&a.testValueTypes(p.types,q))){if((p.setter||(!p.setProperty&&p.getter))&&w.splice(2,1,"set")){v=a.gvsCall(p.setter||p.getter,b,q,f,w);return(v===undefined)?!0:(u?!!v:v)}b[(v=p.setProperty||t)]=q[0];return b[v]===q[0]}}else{if(p.getter){return a.gvsCall(p.getter,b,q,f,w)}return b[p.getProperty||t]}}else{throw new Error('GSet: "'+t+'" has no '+v+"ter")}}else{throw new Error('GSet: "'+t+'" is unmapped')}return !1}};GSet.getContext=function(c){var b={gset:!1,alias:!1,action:!1},d=function(f,e){return typeof f===(e?"object":"function")};if(d(c,1)&&d((c=c.callee))&&d((c=c.caller))&&d((c=c.arguments),1)&&c.length===3){b.gset=c[0];b.alias=c[1];b.action=c[2]}return b}})();
(function(a){var b={fkey:{},tick:new Date()*1,rxp:{oneAlpha:/\w/,absPath:/^\/\//,typeObjFnc:/^(?:object|function)$/,nodeNameBad:/^toString$|[\/\|]|^[_@\[]/,relativePathFlags:/^(?:(?:\.{1,2}|[@\[][^\/]+)\/?)+/,gateOkAction:/^[cg]/,gateBadAlias:/^args|go|target|wait$/,gateOkAlias:/^destroy|type$/},typeOf:function(d){var c=typeof d;return c==="object"&&Object.prototype.toString.call(d)==="[object Array]"?"array":c},isValidFlowId:function(c){return typeof c==="string"&&b.rxp.oneAlpha.test(c)},isFnc:function(c){return typeof c==="function"},superId:"..//",flows:{},activeFlows:[],objects:{},proxies:{},meta:{fncs:{main:"main","in":"in",out:"out",over:"over"},keys:{vars:"vars",root:"root",pendable:"pendable"},prefix:"_"},getFlow:function(c){var e=0,d=b.objects.Flow;switch(typeof c){case"object":if(c instanceof GSet&&c._gset().type===1&&c.type()==="Flow"){e=c._gset(b.fkey)}if(c instanceof d){e=c}break;case"function":if(c.hasOwnProperty("toString")&&b.rxp.absPath.test(c.toString())&&(e=c(b.fkey)) instanceof d){return e}break;case"string":if(b.flows.hasOwnProperty(c)&&b.isValidFlowId(c)){e=b.flows[c]}break}return e}};b.proxies.Flow=new GSet(0,{type:"Flow",id:["id",function(c){return !b.flows.hasOwnProperty(c)&&b.isValidFlowId(c)},function(d){var c=this;if(c.exec&&(!c.childFlows.length||(!c.parentFlows.length&&c.delay.active))){delete b.flows[c.id];c.id=d;b.flows[c.id]=c;return 1}return 0}],map:[function(){var c=this,d=function(e,g){var f=function(h){return c.dead?!1:(h===b.fkey?c:((c.exec||!c.locked)?c.target(e,[].slice.call(arguments)):!1))};f.toString=function(){return e.id};if(g){g[e.name]=f}else{g=f}if(e.nextIdx){d(c.nodes[e.nextIdx],g)}if(e.children.length){d(c.nodes[e.children[0].idx],e.name?f:g)}return g};return d(c.nodes[1])}],status:[function(){var e=this,d=e.cache.proxy,c=e.nodes,l=e.nodes[e.currentIdx],g=function(){},k,h,f;if(!d.status){d.status={}}if(!d.status.simple){d.status.simple={internal:!!e.exec,depth:l.depth.length-1,phase:e.phase,location:l.id,index:l.idx,state:l.name,pendable:!!l.pendable}}g.prototype=d.status.simple;k=e.getPending();for(h=0;k[h];h++){k[h]=k[h].id}g.prototype.pending=k;if(!d.status.traversal){d.status.traversal={paused:!!e.delay.active,loops:((","+e.nodestack.join()).match(new RegExp(",("+l.idx+")\\b","g"))||[]).length};k=[];f=e.nodestack.length;for(h=0;h<f;h++){k.push(c[e.nodestack[h]].id)}d.status.traversal.history=k;k=e.getRoute();for(h=0;k[h];h++){k[h]=k[h].id}d.status.traversal.targets=k}for(h in d.status.traversal){if(d.status.traversal.hasOwnProperty(h)){g.prototype[h]=d.status.traversal[h]}}return new g()}],lock:["locked",0,function(d){var c=this;if(c.exec){c.locked=!d;return 1}return 0}],query:function(){var d=this,e=arguments,f=0,g,c=[];for(;g=d.findNode(e[f]);f++){c.push(g.id)}return(c.length&&c.length===e.length)?(c.length>1?c:c[0]):!1},args:function(){var e=this,g=arguments,d=g[0],c=g[1],f=d>-1&&Math.ceil(d)===d,h=e.args;switch(g.length){case 0:return h.concat();break;case 1:switch(b.typeOf(d)){case"array":e.args=d.concat();return !0;break;case"number":if(f){return h[d]}break}break;default:if(f){if(c===undefined&&d===h.length-1){h.splice(-1,1)}else{h[d]=c}return !0}break}return !1},vars:function(){var f=this,g=arguments,d=g[0],c=g[1],e=typeof d==="string"&&b.rxp.oneAlpha.test(d)&&f.resolveVar(d),h,j=!1;switch(g.length){case 0:j=[];for(h in f.vars){if(f.vars.hasOwnProperty(h)){j.push(h)}}break;case 1:if(e){j=e.values[0]}break;default:if(e){e.values[0]=c;j=!0}break}return j},destroy:function(){var c=this;if(!c.dead){delete b.flows[c.id];c.dead=1;c.clearDelay();c.informParentFlows()}return !!c.dead},wait:function(){var d=this,k=arguments,c=d.cache.proxy,n=k.length,j=Math,g=n>1?k[0]:0,f,m=!g||typeof g==="function"||(f=d.findNode(g)),e=j.ceil(j.abs(k[n-1])),l=!isNaN(e),h=1;if(d.targets.length&&(!n||(l&&m&&f!==!1))){if(c.status){delete c.status.traversal}d.clearDelay();if(f){g=function(){d.target(f)}}d.delay.active=n?a.setTimeout(function(){d.delay.callback=g;d.delay.active=0;d.traverse()},e):1;h=0}return !h},target:function(f){var d=this,c=d.cache.proxy,e=d.findNode(f);if(e){if(c.status){delete c.status.traversal}return d.target(e,[].slice.call(arguments,1))}return !1},go:function(){var e=this,d=e.cache.proxy,f=arguments,c=f.length,k=e.targets.length,j,h=[],g=0;for(;j=e.findNode(f[g]);g++){h.push(j)}if(!c||c===h.length){if(d.status){delete d.status.traversal}e.clearDelay();if(k||h.length){e.stage.waypoints=h;e.traverse();return c?!0:!e.childFlows.length}}return !1}},function(){var d=this,c=GSet.getContext(arguments);return b.rxp.gateOkAlias.test(c.alias)||(!d.dead&&(d.exec||!d.locked||b.rxp.gateOkAction.test(c.action)&&!b.rxp.gateBadAlias.test(c.alias)))},b.fkey);b.objects.Flow=function(e,c){var d=this;d.id=e;d.tree=c;d.currentIdx=0;d.targetIdx=null;d.targets=[];d.dead=!1;d.locked=!1;d.exec=0;d.delay={};d.phase="";d.nodestack=[];d.vars={};d.args=[];d.cache={findNode:{},proxy:{}};d.childFlows={indice:{},length:0};d.parentFlows=[];d.stage={waypoints:[]};b.flows[d.id]=d;d.nodes=[];d.nodeIds={};new b.objects.Node(d,new b.objects.Node(d),c);d.recursionLimit=d.nodes.length*5};b.objects.Flow.prototype={target:function(d,e){var c=this;c.clearDelay();c.targets=[];c.args=e;c.stage.waypoints=[d];return c.traverse()},traverse:function(){var d=this,g,c,e,h,f=0;if(d.exec||d.childFlows.length){return !d.childFlows.length}if(d.delay.callback){c=d.delay.callback;d.delay.callback=0;d.execute(c);return d.delay.active?0:d.traverse()}if(d.cache.proxy.status){delete d.cache.proxy.status}d.commitStage();while(d.recursionLimit>f++&&!d.dead&&!d.delay.active&&!d.childFlows.length&&d.targets.length){d.phase=0;h=0;d.targetIdx=d.targets[0].idx;g=d.nodes[d.currentIdx];e=d.getNextMove(g,d.nodes[d.targetIdx]);if(!e.none){if(e.right||e.left){if(g.inContext){d.phase=b.meta.fncs.out}else{if(e.right){d.phase=b.meta.fncs.over}}g.inContext=0;d.stage.currentIdx=e.right?g.nextIdx:g.previousIdx}if(e.up){d.phase=b.meta.fncs.out;g.inContext=0;d.stage.currentIdx=g.parentIdx}if(e.down){if(!g.inContext){d.phase=b.meta.fncs["in"]}g.inContext=1;d.stage.currentIdx=g.firstChildIdx}}else{d.phase=b.meta.fncs[g.inContext?"main":"in"];d.stage.hitTarget=g.inContext;g.inContext=1}if(d.phase){if(d.outNode){d.outNode.descopeVars()}d.outNode=0;if(d.phase===b.meta.fncs["in"]){g.scopeVars()}if(h=g.fncs.hasOwnProperty(d.phase)){if(d.phase===b.meta.fncs.out){d.outNode=g}d.result=d.execute(g.fncs[d.phase],(d.targets.length===1&&d.phase===b.meta.fncs.main)?d.args:[])}else{if(d.phase===b.meta.fncs.out){g.descopeVars()}}}if(!d.dead&&!d.delay.active&&!d.childFlows.length){d.commitStage()}}if(f>d.recursionLimit){c=(","+d.nodestack.join()).match(/(,\d+\b)+\1$/);if(c){c=c[1].substr(1).split(",");for(i=0;i<c.length;i++){c[i]=d.nodes[c[i]].name}throw new Error("Flow: bad redirects [ "+c.join(" > ")+" ]")}else{throw new Error("Flow: too much recursion")}}d.nodestack=[];if(!d.dead&&!d.targets.length){d.informParentFlows()}return !d.targets.length&&!d.dead?(h&&d.result!==undefined?d.result:!0):!1},execute:function(g,e){var d=this,f=d.nodes[d.currentIdx],c;d.cache.proxy={};d.exec=1;if(f.pendable){if(b.activeFlows.length){d.parentFlows.push(b.activeFlows[0].id);b.activeFlows[0].addChildFlow(d.id)}b.activeFlows.unshift(d)}c=g.apply(d.getGSet(),e||[]);if(f.pendable){b.activeFlows.shift()}d.exec=0;d.cache.proxy={};return c},commitStage:function(d){var c=this,m,f=0,e,g=c.stage,j,k=c.phase,l=b.meta.fncs,h;c.targets=c.getRoute();j=c.targets;if(j.length){h=j[j.length-1].idx;if(!c.nodestack.length||(k&&c.currentIdx!==c.nodestack[c.nodestack.length-1]&&(k===l.over||k===l.out||(k===l["in"]&&(c.currentIdx!==h))))){c.nodestack.push(c.currentIdx)}}if(g.valid){if(g.currentIdx!=null){c.currentIdx=g.currentIdx}if(g.hitTarget){j.shift();if(!j.length){c.args=[];c.targetIdx=null;c.phase=""}}}c.stage={fnc:0,valid:1,currentIdx:null,hitTarget:0,waypoints:[]}},getNextMove:function(f,g){var d=this,e=g.idx-f.idx,c={};if(e){if(f.parentIdx===g.parentIdx){c[e>0?"right":"left"]=1}else{if(f.depth.length===g.depth.length){c.up=1}else{if(g.path.indexOf(f.path)===0){c.down=1}else{if(e>0){if(g.path.indexOf(d.nodes[f.parentIdx].path)===0){c.right=1}else{c.up=1}}else{if(g.idx!==f.parentIdx&&g.path.indexOf(d.nodes[f.parentIdx].path)===0){c.left=1}else{c.up=1}}}}}}else{c.none=1}return c},getRoute:function(){var c=this,f=c.phase===b.meta.fncs.main,e=c.stage.waypoints.concat(),h=e.length,g=c.targets,d=g.concat();if(h){if(!g.length){d=e}else{if(e[h-1]===d[f?1:0]){e.pop()}if(f){d=[].concat(d[0],e,d.slice(1))}else{d=e.concat(d)}}}c.stage.valid=d[0]===g[0];return d},getPending:function(k,h,l){var d=this,g=k||[],m=h||{},c=l||{},f,e=d.childFlows,j;c[d.id]=1;if(e.length){for(f in e.indice){if(e.indice.hasOwnProperty(f)&&e.indice[f]>0&&(j=b.flows[f])){if(j.delay.active&&!m.hasOwnProperty(j.id)){m[j.id]=g.push(j)}if(!c.hasOwnProperty(j.id)){j.getPending(g,m,c)}}}}return g},addChildFlow:function(e){var c=this,d=c.childFlows;if(!d.indice.hasOwnProperty(e)){d.indice[e]=0}d.indice[e]++;d.length++},removeChildFlow:function(e){var c=this,d=c.childFlows;if(d.length&&d.indice.hasOwnProperty(e)&&d.indice[e]>0){d.indice[e]--;d.length--;if(!d.length&&!c.delay.active){c.traverse()}}},informParentFlows:function(){var c=this,e=0,d=c.parentFlows,f,g;if(d.length){g=d.concat();d.length=0;for(;g[e];e++){if(f=b.flows[g[e]]){f.removeChildFlow(c.id)}}}},resolveVar:function(d){var c=this;return c.vars.hasOwnProperty(d)?c.vars[d]:new b.objects.Var(c,d)},getGSet:function(){return new GSet(this,b.proxies.Flow,b.fkey)},findNode:function(h){var d=this,j=d.nodes[d.currentIdx],g=!1,f,c,e="/";switch(typeof h){case"number":g=d.nodes[+h];break;case"object":if(h instanceof GSet&&h._gset().type===1&&h.type()==="Node"){g=h._gset(b.fkey)}if(h instanceof b.objects.Node){g=h}break;case"string":case"function":f=h=h.toString();if(h===b.superId){g=d.nodes[0]}else{if(h.length&&(h.length<3||!/\/{2,3}$/.test(h))){if(h.substr(0,2)==="//"){if(h.charAt(h.length-1)!==e){h+=e}g=d.nodes[d.nodeIds[h]]}else{f=(h.charAt(0)===e?j.rootIdx:j.idx)+f;if(!d.cache.findNode.hasOwnProperty(f)){c=h.match(b.rxp.relativePathFlags);if(c){h=h.substr(c[0].length);c=c[0].replace(/\/$/,"").split(e)}else{c=[]}d.cache.findNode[f]=j.getRelatedNode(c,h)}g=d.cache.findNode[f]}}}break}return g},clearDelay:function(){var c=this,e=1;if(c.delay.active!==null){c.delay.callback=0;a.clearTimeout(c.delay.active);c.delay.active=e=null}return !e}};b.objects.Var=function(d,e){var c=this;c.flow=d;c.key=e;c.values=[undefined];d.vars[e]=c};b.objects.Var.prototype={descope:function(){var c=this;c.values.shift();if(!c.values.length){delete c.flow.vars[c.key]}return 1},scope:function(){var c=this;c.values.unshift(c.values[0]);return 1}};b.objects.Node=function(d,j,e,c){var f=this,g,h,m=b.meta,k=m.fncs,l=m.keys;if(!j){e={};c="_flow"}f.flow=d;f.idx=d.nodes.push(f)-1;f.children=[];f.childrenNames={};f.fncs={};f.vars={};f.pendable=!j?1:j.pendable;f.name=c||"_root";f.isRoot=!c||!j;f.rootIdx=f.isRoot?f.idx:j.rootIdx;f.depth=j?j.depth.concat(c?c:""):[""];f.path=f.depth.join("/")+"/";f.pathPrefix=f.idx>1?f.path:"//";f.id=j?f.path:b.superId;d.nodeIds[f.id]=f.idx;if(j){f.parentIdx=j.idx;f.localChildIdx=j.children.push(f)-1;j.lastChildIdx=f.idx;j.childrenNames[f.name]=f.idx;if(f.localChildIdx){f.previousIdx=j.children[f.localChildIdx-1].idx;j.children[f.localChildIdx-1].nextIdx=f.idx}else{j.firstChildIdx=f.idx}}if(b.isFnc(e)){f.fncs[k.main]=e}else{for(g in e){if(e.hasOwnProperty(g)){if(g.charAt(0)===m.prefix){h=g.substring(1);if(k[h]&&b.isFnc(e[g])){f.fncs[h]=e[g]}else{if(l[h]&&!b.isFnc(e[g])){switch(l[h]){case l.vars:f.sanitizeAddVarDef(e[g]);break;case l.root:if(f.isRoot=!!e[g]){f.rootIdx=f.idx}break;case l.pendable:f.pendable=!!e[g];break}}else{}}}else{if(b.rxp.typeObjFnc.test(typeof e[g])&&!b.rxp.nodeNameBad.test(g)){new b.objects.Node(d,f,e[g],g)}}}}}f.localPath=j?f.id.substr(Math.max(d.nodes[f.rootIdx].id.length-1,1)):"/"};b.objects.Node.prototype={addVarDef:function(c){var f=this,e=0,d;if(typeof c==="object"){for(d in c){if(c.hasOwnProperty(d)){f.vars[d]={name:d,value:c[d],useValue:1};e++}}}else{if(b.rxp.oneAlpha.test(c)){f.vars[c]={name:c,useValue:0};e++}}return e},sanitizeAddVarDef:function(){var g=this,d=[].slice.call(arguments),f=0,c=d.length,e=0;for(;f<c;f++){switch(b.typeOf(d[f])){case"array":e+=g.sanitizeAddVarDef.apply(g,d[f]);break;case"string":case"object":e+=g.addVarDef(d[f]);break;default:}}return e},scopeVars:function(){var e=this,c=e.flow,d;for(d in e.vars){if(e.vars.hasOwnProperty(d)){if(c.vars.hasOwnProperty(d)){c.vars[d].scope()}else{c.resolveVar(d)}if(e.vars[d].useValue){c.vars[d].values[0]=e.vars[d].value}}}},descopeVars:function(){var e=this,c=e.flow,d;for(d in e.vars){if(e.vars.hasOwnProperty(d)&&c.vars.hasOwnProperty(d)){c.vars[d].descope()}}},getRelatedNode:function(d,m){var e=this,c=e.flow,j=c.nodes[e.parentIdx],f,g,h=0,k,l="/";if(d.length){k=d.shift();k=(/^\[.+\]$/.test(k))?k.slice(1,-1).split("|"):[k];g=k.length;while(f==null&&h<g){if(/^@|^\.+$/.test(k[h])){if(k[h].charAt(0)==="@"){k[h]=k[h].substr(1)}switch(k[h]){case"child":f=e.firstChildIdx;break;case"next":f=e.nextIdx;break;case"oldest":if(j){f=j.lastChildIdx}break;case"parent":case"..":f=e.parentIdx;break;case"previous":f=e.previousIdx;break;case"root":f=e.rootIdx;break;case"program":f=1;break;case"flow":f=0;break;case"youngest":if(j){f=j.firstChildIdx}break;case"self":case".":f=e.idx;break}}else{f=e.childrenNames[k[h]]}h++}e=c.nodes[f];return e?e.getRelatedNode(d,m):!1}else{if(m.length){if(m.charAt(0)!==l){m=e.pathPrefix+m}else{if(m.charAt(1)!==l){m=(e.rootIdx>1?c.nodes[e.rootIdx].path.slice(0,-1):l)+m}}if(m.charAt(m.length-1)!==l){m+=l}return c.nodeIds.hasOwnProperty(m)&&c.nodes[c.nodeIds[m]]}else{return e}}}};a.Flow=function(){var f=this,g=arguments,e=g.length,k=g[0],j=typeof k==="string",h,d,c;if(!(f.hasOwnProperty&&f instanceof arguments.callee)){if(!e){k=[];for(h in b.flows){if(b.flows.hasOwnProperty(h)){k.push(h)}}return k}return(f=b.getFlow(k))?f.getGSet():!1}if(!e){throw new Error("Flow: missing tree")}if(e>2){c=g[1];d=g[2]}else{if(e>1){if(!j){k=0;d=g[1]}c=g[j?1:0]}else{k=0;c=g[0]}}if(typeof c!=="object"){throw new Error("Flow: invalid tree")}f=(new b.objects.Flow((k&&!b.flows.hasOwnProperty(k)&&b.isValidFlowId(k))?k:(b.tick++).toString(20),c)).getGSet();return d?f:f.map()}})(this);